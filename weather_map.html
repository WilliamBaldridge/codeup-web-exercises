<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weather Map Project</title>

    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no"/>
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.1.0/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.1.0/mapbox-gl.css" rel="stylesheet"/>
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.2.0/mapbox-gl-geocoder.min.js'></script>
    <link rel='stylesheet'
          href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.2.0/mapbox-gl-geocoder.css'
          type='text/css'/>
    <link rel="stylesheet" href="css/weather_map.css">


</head>
<body>

<div class='sidebar'>
    <div class='heading'>
        <h1>Local Weather</h1>
    </div>
    <div id='listings' class='listings'></div>
</div>
<div id="map" class="map markers"></div>

<script src="js/jquery-3.5.1.js"></script>
<script src="js/keys.js"></script>
<script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>
<script src="js/mapbox_utility.js"></script>

<script>

    // $.get("https://api.openweathermap.org/data/2.5/onecall?lat=29.5&lon=-97.8&units=imperial&exclude=minutely,hourly&appid=" + WEATHER_MAP_TOKEN).done(function (data) {
    //     console.log(data);
    // });
    mapboxgl.accessToken = MAPBOX_TOKEN;

    weatherData();

    function weatherData() {
        $.get("https://api.openweathermap.org/data/2.5/onecall?", {
            APPID: WEATHER_MAP_TOKEN,
            lat: 29.4241,
            lon: -98.4936,
            units: "imperial",
            exclude: "minutely, hourly"
        }).done(function (data) {
            console.log(data);
            console.log(data.daily[0]);
            console.log(data.daily[0].temp.min);


            var map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/williambaldridge/ckkyb7dzt2kvb17qo6sc7vhcv',
                center: [-98.49, 29.50],
                zoom: 7,
            });

            map.on("load", function (e) {
                var geocoder = new MapboxGeocoder({
                    accessToken: mapboxgl.accessToken, // Set the access token
                    mapboxgl: mapboxgl, // Set the mapbox-gl instance
                    marker: true, // Use the geocoder's default marker style
                });
                map.addControl(new mapboxgl.NavigationControl());
                map.addControl(geocoder, 'top-left');
                console.log(geocoder);
                console.log(geocoder.options.marker);
                // console.log(JSON.stringify(geocoder.geocoderService.inputString));
                // console.log(geocoder.inputString);
            });
            // document.addEventListener('change', function (e) {
            //     if (e.target.className.indexOf('mapboxgl-ctrl-geocoder--input') !== -1) {
            //         console.log(e.target.value);
            //         geocode(e.target.value, MAPBOX_TOKEN).then(function (data) {
            //             var geocoderSearch = new mapboxgl.Marker()
            //                 .setLngLat(data)
            //                 .addTo(map);
            //             console.log(data);
            //             // return data;
            //             var latitude = data[0];
            //             var longitude = data[1];
            //             // console.log(latitude);
            //             // console.log(longitude);
            //
            //             return latitude + longitude + "";
            //         });
            //         // console.log(searchInput);
            //     }
            //
            // });


        });
    }


    // var map = new mapboxgl.Map({
    //     container: 'map',
    //     style: 'mapbox://styles/williambaldridge/ckkyb7dzt2kvb17qo6sc7vhcv',
    //     center: [-98.49, 29.50],
    //     zoom: 7,
    // });
    //
    // map.on("load", function (e) {
    //     var geocoder = new MapboxGeocoder({
    //         accessToken: mapboxgl.accessToken, // Set the access token
    //         mapboxgl: mapboxgl, // Set the mapbox-gl instance
    //         marker: false, // Use the geocoder's default marker style
    //     });
    //     map.addControl(new mapboxgl.NavigationControl());
    //     map.addControl(geocoder, 'top-left');
    //     console.log(geocoder);
    //     // console.log(JSON.stringify(geocoder.geocoderService.inputString));
    //     // console.log(geocoder.inputString);
    // });

    // document.addEventListener('change', function (e) {
    //         if (e.target.className.indexOf('mapboxgl-ctrl-geocoder--input') !== -1) {
    //             console.log(e.target.value);
    //             // return e.target.value;
    //         }
    //     });
    //
    //     document.addEventListener('change', function (e) {
    //         if (e.target.className.indexOf('mapboxgl-ctrl-geocoder--input') !== -1) {
    //             console.log(e.target.value);
    //             geocode(e.target.value, MAPBOX_TOKEN).then(function (data) {
    //                 var geocoderSearch = new mapboxgl.Marker()
    //                     .setLngLat(data)
    //                     .addTo(map);
    //                 console.log(data);
    //                 // return data;
    //                 var latitude = data[0];
    //                 var longitude = data[1];
    //                 // console.log(latitude);
    //                 // console.log(longitude);
    //
    //                 return latitude + longitude + "";
    //             });
    //             // console.log(searchInput);
    //         }
    //
    //     });
    //
    // }

    // var searchInput = document.addEventListener('change', function(e) {
    //     if (e.target.className.indexOf('mapboxgl-ctrl-geocoder--input') !== -1) {
    //         console.log(e.target.value);
    //         // return e.target.value;
    //         geocode(searchInput, MAPBOX_TOKEN).then(function(data) {
    //             var geocoderSearch = new mapboxgl.Marker()
    //                 .setLngLat(data)
    //                 .addTo(map);
    //             console.log(data);
    //         });
    //     }
    // });


    // console.log(searchInput);


</script>

</body>
</html>